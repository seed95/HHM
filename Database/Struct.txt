CREATE TABLE `hhm_db`.`files` (
  `id` INT NOT NULL,
  `filename` TEXT NOT NULL,
  `r_ids` TEXT NOT NULL COMMENT 'Receiver ids in csv format',
  `s_id` INT NOT NULL,
  PRIMARY KEY (`id`));

CREATE TABLE `hhm_db`.`message` (
  `id` INT NOT NULL,
  `sender_id` INT NOT NULL,
  `to_ids` VARCHAR(45) NOT NULL COMMENT 'To user ids in csv format',
  `cc_ids` VARCHAR(45) NULL COMMENT 'Cc user ids in csv format',
  `subject` TEXT NULL,
  `content` TEXT NULL,
  `file_ids` VARCHAR(45) NULL COMMENT 'Reference to files table in csv format',
  PRIMARY KEY (`id`));

ALTER TABLE `hhm_db`.`message` 
ADD INDEX `sender_ind` (`sender_id` ASC);
ALTER TABLE `hhm_db`.`message` 
ADD CONSTRAINT `sender_key`
  FOREIGN KEY (`sender_id`)
  REFERENCES `hhm_db`.`user` (`id`)
  ON DELETE CASCADE
  ON UPDATE CASCADE;

ALTER TABLE `hhm_db`.`message` 
CHANGE COLUMN `id` `id` INT(11) NOT NULL AUTO_INCREMENT ;

ALTER TABLE `hhm_db`.`message` 
CHANGE COLUMN `to_ids` `to_ids` VARCHAR(45) NULL COMMENT 'To user ids in csv format' ;

ALTER TABLE `hhm_db`.`message` 
ADD COLUMN `date_time` DATETIME NULL AFTER `file_ids`;

ALTER TABLE `hhm_db`.`files` 
DROP COLUMN `r_ids`,
ADD COLUMN `to_ids` VARCHAR(45) NOT NULL COMMENT 'To ids for receive in csv format' AFTER `s_id`,
ADD COLUMN `cc_ids` VARCHAR(45) NOT NULL COMMENT 'Cc ids in csv format' AFTER `to_ids`;

ALTER TABLE `hhm_db`.`files` 
CHANGE COLUMN `id` `id` INT(11) NOT NULL AUTO_INCREMENT ;


ALTER TABLE `hhm_db`.`message` 
CHANGE COLUMN `subject` `subject` TEXT CHARACTER SET 'utf8' NULL DEFAULT NULL ;

ALTER TABLE `hhm_db`.`message` 
CHANGE COLUMN `content` `content` TEXT CHARACTER SET 'utf8' NULL DEFAULT NULL ;

ALTER SCHEMA `hhm_db`  DEFAULT CHARACTER SET utf8 ;

ALTER TABLE `hhm_db`.`document` 
ADD COLUMN `file_ids` VARCHAR(45) NULL DEFAULT NULL COMMENT 'files ids in csv format' AFTER `table_data6`;





